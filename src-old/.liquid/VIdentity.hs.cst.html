<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>src/VIdentity.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum> 1: </span><a class=annot href="#"><span class=annottext>{VV##710 : GHC.Types.Module | $k_##711}</span><span class='hs-keyword'>module</span></a> <span class='hs-conid'>VIdentity</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 2: </span>
<span class=hs-linenum> 3: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Function</span>
<span class=hs-linenum> 4: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Language.Haskell.Liquid.ProofCombinators</span>
<span class=hs-linenum> 5: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Relation</span>
<span class=hs-linenum> 6: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>VFunctor</span>
<span class=hs-linenum> 7: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>VMonad</span>
<span class=hs-linenum> 8: </span>
<span class=hs-linenum> 9: </span><span class='hs-comment'>-- Data. The identity functor trivially wraps a type with its single</span>
<span class=hs-linenum>10: </span><span class='hs-comment'>-- constructor.</span>
<span class=hs-linenum>11: </span><span class='hs-keyword'>{-@</span>
<span class=hs-linenum>12: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>VIdentity</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>VIdentity</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>13: </span><span class='hs-keyword'>@-}</span>
<span class=hs-linenum>14: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>VIdentity</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>VIdentity</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>15: </span>
<span class=hs-linenum>16: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>reflect</span> <span class='hs-varid'>vmapF_VIdentity</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>17: </span><span class='hs-definition'>vmapF_VIdentity</span> <span class='hs-keyglyph'>::</span>
<span class=hs-linenum>18: </span>  <span class='hs-keyword'>forall</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-varop'>.</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>VIdentity</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>VIdentity</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<span class=hs-linenum>19: </span><a class=annot href="#"><span class=annottext>forall a b .
lq_tmp$x##663:(lq_tmp$x##662:a -&gt; b) -&gt; lq_tmp$x##664:(VIdentity.VIdentity a) -&gt; {VV : (VIdentity.VIdentity b) | VV == VIdentity.vmapF_VIdentity lq_tmp$x##663 lq_tmp$x##664
                                                                                                                 &amp;&amp; VV == VIdentity.VIdentity (lq_tmp$x##663 (lqdc##$select##VIdentity.VIdentity##1 lq_tmp$x##664))}</span><span class='hs-definition'>vmapF_VIdentity</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##666:a -&gt; b</span><span class='hs-varid'>f</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>VIdentity</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      lq_tmp$x##697:a -&gt; {lq_tmp$x##695 : (VIdentity.VIdentity a) | lqdc##$select##VIdentity.VIdentity##1 lq_tmp$x##695 == lq_tmp$x##697
                                                                    &amp;&amp; lqdc##$select##VIdentity.VIdentity##1 lq_tmp$x##695 == lq_tmp$x##697
                                                                    &amp;&amp; (is$VIdentity.VIdentity lq_tmp$x##695 &lt;=&gt; true)
                                                                    &amp;&amp; lq_tmp$x##695 == VIdentity.VIdentity lq_tmp$x##697} | VV == VIdentity.VIdentity}</span><span class='hs-conid'>VIdentity</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##688 : b | lq_tmp$x##688 == f##a7a4 x##a7a5}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>f</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##691 : a | lq_tmp$x##691 == x##a7a5}</span><span class='hs-varid'>x</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>20: </span>
<span class=hs-linenum>21: </span><span class='hs-comment'>-- TODO: prove</span>
<span class=hs-linenum>22: </span><span class='hs-comment'>-- {-@ automatic-instances vmapF_vid_VIdentity @-}</span>
<span class=hs-linenum>23: </span><span class='hs-keyword'>{-@</span>
<span class=hs-linenum>24: </span><span class='hs-definition'>assume</span> <span class='hs-varid'>vmapF_vid_VIdentity</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>a</span><span class='hs-varop'>.</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-conid'>VIdentity</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum>25: </span>  <span class='hs-keyword'>{vmapF_VIdentity vid x = vid x}</span>
<span class=hs-linenum>26: </span><span class='hs-keyword'>@-}</span>
<span class=hs-linenum>27: </span><span class='hs-definition'>vmapF_vid_VIdentity</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>a</span><span class='hs-varop'>.</span> <span class='hs-conid'>VIdentity</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Proof</span>
<span class=hs-linenum>28: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##705:(VIdentity.VIdentity a) -&gt; {VV : () | VIdentity.vmapF_VIdentity Function.vid lq_tmp$x##705 == Function.vid lq_tmp$x##705}</span><span class='hs-definition'>vmapF_vid_VIdentity</span></a> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>29: </span>
<span class=hs-linenum>30: </span><span class='hs-comment'>-- TODO: prove that VIdentity is a VFunctor</span>
<span class=hs-linenum>31: </span><span class='hs-comment'>-- -- TODO: why does vmapF_vid_VIdentity need to be qualified?</span>
<span class=hs-linenum>32: </span><span class='hs-comment'>-- {-@ reflect iFunctor_VIdentity @-}</span>
<span class=hs-linenum>33: </span><span class='hs-comment'>-- iFunctor_VIdentity :: VFunctor VIdentity</span>
<span class=hs-linenum>34: </span><span class='hs-comment'>-- iFunctor_VIdentity =</span>
<span class=hs-linenum>35: </span><span class='hs-comment'>--   VFunctor {vmapF = vmapF_VIdentity, vmapF_vid = VIdentity.vmapF_vid_VIdentity}</span>
<span class=hs-linenum>36: </span>
<span class=hs-linenum>37: </span><span class='hs-comment'>-- {-@ reflect lift_VIdentity @-}</span>
<span class=hs-linenum>38: </span><span class='hs-comment'>-- lift_VIdentity :: forall a. a -&gt; VIdentity a</span>
<span class=hs-linenum>39: </span><span class='hs-comment'>-- lift_VIdentity = VIdentity</span>
<span class=hs-linenum>40: </span>
<span class=hs-linenum>41: </span><span class='hs-comment'>-- {-@ reflect bind_VIdentity @-}</span>
<span class=hs-linenum>42: </span><span class='hs-comment'>-- bind_VIdentity ::</span>
<span class=hs-linenum>43: </span><span class='hs-comment'>--   forall a b. VIdentity a -&gt; (a -&gt; VIdentity b) -&gt; VIdentity b</span>
<span class=hs-linenum>44: </span><span class='hs-comment'>-- bind_VIdentity (VIdentity x) k = k x</span>
<span class=hs-linenum>45: </span>
<span class=hs-linenum>46: </span><span class='hs-comment'>-- {-@</span>
<span class=hs-linenum>47: </span><span class='hs-comment'>-- bind_correct_VIdentity :: forall a b . m:VIdentity a -&gt; f:(a -&gt; b) -&gt;</span>
<span class=hs-linenum>48: </span><span class='hs-comment'>--   {bind_VIdentity m (vcomp lift_VIdentity f) = vmapF iFunctor_VIdentity f m}</span>
<span class=hs-linenum>49: </span><span class='hs-comment'>-- @-}</span>
<span class=hs-linenum>50: </span><span class='hs-comment'>-- bind_correct_VIdentity ::</span>
<span class=hs-linenum>51: </span><span class='hs-comment'>--   forall a b. VIdentity a -&gt; (a -&gt; b) -&gt; Proof</span>
<span class=hs-linenum>52: </span><span class='hs-comment'>-- bind_correct_VIdentity _ _ = ()</span>
<span class=hs-linenum>53: </span>
<span class=hs-linenum>54: </span><span class='hs-comment'>-- {-@</span>
<span class=hs-linenum>55: </span><span class='hs-comment'>-- bind_identity_VIdentity :: forall a . m:VIdentity a -&gt;</span>
<span class=hs-linenum>56: </span><span class='hs-comment'>--   {bind_VIdentity m lift_VIdentity = m}</span>
<span class=hs-linenum>57: </span><span class='hs-comment'>-- @-}</span>
<span class=hs-linenum>58: </span><span class='hs-comment'>-- bind_identity_VIdentity :: forall a. VIdentity a -&gt; Proof</span>
<span class=hs-linenum>59: </span><span class='hs-comment'>-- bind_identity_VIdentity _ = ()</span>
<span class=hs-linenum>60: </span>
<span class=hs-linenum>61: </span><span class='hs-comment'>-- {-@</span>
<span class=hs-linenum>62: </span><span class='hs-comment'>-- bind_lift_VIdentity :: forall a b . k:(a -&gt; VIdentity b) -&gt; x:a -&gt;</span>
<span class=hs-linenum>63: </span><span class='hs-comment'>--   {bind_VIdentity (lift_VIdentity x) k = k x}</span>
<span class=hs-linenum>64: </span><span class='hs-comment'>-- @-}</span>
<span class=hs-linenum>65: </span><span class='hs-comment'>-- bind_lift_VIdentity :: forall a b. (a -&gt; VIdentity b) -&gt; a -&gt; Proof</span>
<span class=hs-linenum>66: </span><span class='hs-comment'>-- bind_lift_VIdentity _ _ = ()</span>
<span class=hs-linenum>67: </span>
<span class=hs-linenum>68: </span><span class='hs-comment'>-- {-@</span>
<span class=hs-linenum>69: </span><span class='hs-comment'>-- bind_bind_VIdentity :: forall a b c . m:VIdentity a -&gt; k1:(a -&gt; VIdentity b) -&gt; k2:(b -&gt; VIdentity c) -&gt;</span>
<span class=hs-linenum>70: </span><span class='hs-comment'>--   {bind_VIdentity (bind_VIdentity m k1) k2 = bind_VIdentity m (raw_kleisli bind_VIdentity k1 k2)}</span>
<span class=hs-linenum>71: </span><span class='hs-comment'>-- @-}</span>
<span class=hs-linenum>72: </span><span class='hs-comment'>-- bind_bind_VIdentity ::</span>
<span class=hs-linenum>73: </span><span class='hs-comment'>--   forall a b c.</span>
<span class=hs-linenum>74: </span><span class='hs-comment'>--   VIdentity a -&gt;</span>
<span class=hs-linenum>75: </span><span class='hs-comment'>--   (a -&gt; VIdentity b) -&gt;</span>
<span class=hs-linenum>76: </span><span class='hs-comment'>--   (b -&gt; VIdentity c) -&gt;</span>
<span class=hs-linenum>77: </span><span class='hs-comment'>--   Proof</span>
<span class=hs-linenum>78: </span><span class='hs-comment'>-- bind_bind_VIdentity _ _ _ = ()</span>
<span class=hs-linenum>79: </span>
<span class=hs-linenum>80: </span><span class='hs-comment'>-- {-@ reflect iMonad_VIdentity @-}</span>
<span class=hs-linenum>81: </span><span class='hs-comment'>-- iMonad_VIdentity :: VMonad VIdentity</span>
<span class=hs-linenum>82: </span><span class='hs-comment'>-- iMonad_VIdentity =</span>
<span class=hs-linenum>83: </span><span class='hs-comment'>--   VMonad</span>
<span class=hs-linenum>84: </span><span class='hs-comment'>--     { iFunctor = iFunctor_VIdentity,</span>
<span class=hs-linenum>85: </span><span class='hs-comment'>--       bind = bind_VIdentity,</span>
<span class=hs-linenum>86: </span><span class='hs-comment'>--       lift = lift_VIdentity,</span>
<span class=hs-linenum>87: </span><span class='hs-comment'>--       bind_correct = bind_correct_VIdentity,</span>
<span class=hs-linenum>88: </span><span class='hs-comment'>--       bind_identity = bind_identity_VIdentity,</span>
<span class=hs-linenum>89: </span><span class='hs-comment'>--       bind_lift = bind_lift_VIdentity,</span>
<span class=hs-linenum>90: </span><span class='hs-comment'>--       bind_bind = bind_bind_VIdentity</span>
<span class=hs-linenum>91: </span><span class='hs-comment'>--     }</span>
</pre>
</body>
</html>