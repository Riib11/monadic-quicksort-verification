<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>src/Test.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum>  1: </span><a class=annot href="#"><span class=annottext>GHC.Types.Module</span><span class='hs-keyword'>module</span></a> <span class='hs-conid'>Test</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>  2: </span>
<span class=hs-linenum>  3: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Language.Haskell.Liquid.Equational</span>
<span class=hs-linenum>  4: </span>
<span class=hs-linenum>  5: </span><span class='hs-comment'>-- Data. A list is either `LNil` or constructed with a `vhead` element and a</span>
<span class=hs-linenum>  6: </span><span class='hs-comment'>-- `vtail` list.</span>
<span class=hs-linenum>  7: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>LList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>LNil</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>LCons</span> <span class='hs-layout'>{</span><span class='hs-varid'>vhead</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-varid'>vtail</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>LList</span> <span class='hs-varid'>a</span><span class='hs-layout'>}</span>
<span class=hs-linenum>  8: </span>
<span class=hs-linenum>  9: </span><span class='hs-comment'>-- Function. Append two lists.</span>
<span class=hs-linenum> 10: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>reflect</span> <span class='hs-varid'>lappend</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 11: </span><span class='hs-definition'>lappend</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>LList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>LList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>LList</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 12: </span><a class=annot href="#"><span class=annottext>forall a .
x1:(Test.LList a) -&gt; x2:(Test.LList a) -&gt; {VV : (Test.LList a) | VV == lappend x1 x2}</span><span class='hs-definition'>lappend</span></a> <span class='hs-conid'>LNil</span> <a class=annot href="#"><span class=annottext>(Test.LList a)</span><span class='hs-varid'>ys</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (Test.LList a) | v == ys}</span><span class='hs-varid'>ys</span></a>
<span class=hs-linenum> 13: </span><span class='hs-definition'>lappend</span> <span class='hs-layout'>(</span><span class='hs-conid'>LCons</span> <span class='hs-varid'>x</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-varid'>ys</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      x1:a -&gt; x2:(Test.LList a) -&gt; {v : (Test.LList a) | LCons##lqdc##$select v == x2
                                                         &amp;&amp; LCons##lqdc##$select v == x1
                                                         &amp;&amp; v == LCons x1 x2} | VV == LCons}</span><span class='hs-conid'>LCons</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v : (Test.LList a) | v == lappend xs ys}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>lappend</span> <a class=annot href="#"><span class=annottext>{v : (Test.LList a) | v == xs}</span><span class='hs-varid'>xs</span></a> <a class=annot href="#"><span class=annottext>{v : (Test.LList a) | v == ys}</span><span class='hs-varid'>ys</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 14: </span>
<span class=hs-linenum> 15: </span><span class='hs-comment'>-- Function. Construct a list with 1 element.</span>
<span class=hs-linenum> 16: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>reflect</span> <span class='hs-varid'>llist1</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 17: </span><span class='hs-definition'>llist1</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>LList</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 18: </span><a class=annot href="#"><span class=annottext>forall a .
x1:a -&gt; {VV : (Test.LList a) | VV == llist1 x1
                               &amp;&amp; VV == LCons x1 LNil}</span><span class='hs-definition'>llist1</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>LCons</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{VV : forall a . {v : (Test.LList a) | v == LNil} | VV == LNil}</span><span class='hs-conid'>LNil</span></a>
<span class=hs-linenum> 19: </span>
<span class=hs-linenum> 20: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>reflect</span> <span class='hs-varid'>lsingleton</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 21: </span><span class='hs-definition'>lsingleton</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>LList</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 22: </span><a class=annot href="#"><span class=annottext>forall a .
x1:a -&gt; {VV : (Test.LList a) | VV == lsingleton x1
                               &amp;&amp; VV == llist1 x1}</span><span class='hs-definition'>lsingleton</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>llist1</span>
<span class=hs-linenum> 23: </span>
<span class=hs-linenum> 24: </span><span class='hs-comment'>-- Function. Construct a list with 2 elements.</span>
<span class=hs-linenum> 25: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>reflect</span> <span class='hs-varid'>llist2</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 26: </span><span class='hs-definition'>llist2</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>LList</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 27: </span><a class=annot href="#"><span class=annottext>forall a .
x1:a -&gt; x2:a -&gt; {VV : (Test.LList a) | VV == llist2 x1 x2
                                       &amp;&amp; VV == lappend (llist1 x1) (llist1 x2)}</span><span class='hs-definition'>llist2</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>y</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (Test.LList a) | v == llist1 x
                      &amp;&amp; v == LCons x LNil}</span><span class='hs-varid'>llist1</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>`lappend`</span> <a class=annot href="#"><span class=annottext>{v : (Test.LList a) | v == llist1 y
                      &amp;&amp; v == LCons y LNil}</span><span class='hs-varid'>llist1</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == y}</span><span class='hs-varid'>y</span></a>
<span class=hs-linenum> 28: </span>
<span class=hs-linenum> 29: </span><span class='hs-comment'>-- Function. Map a list-function over a list and concatenate the resulting</span>
<span class=hs-linenum> 30: </span><span class='hs-comment'>-- lists (i.e. list-monadic bind).</span>
<span class=hs-linenum> 31: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>reflect</span> <span class='hs-varid'>lbind</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 32: </span><span class='hs-definition'>lbind</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>LList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>LList</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>LList</span> <span class='hs-varid'>b</span>
<span class=hs-linenum> 33: </span><a class=annot href="#"><span class=annottext>forall a b .
x1:(Test.LList a) -&gt; x2:(a -&gt; (Test.LList b)) -&gt; {VV : (Test.LList b) | VV == lbind x1 x2}</span><span class='hs-definition'>lbind</span></a> <span class='hs-conid'>LNil</span> <a class=annot href="#"><span class=annottext>a -&gt; (Test.LList b)</span><span class='hs-varid'>f</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a . {v : (Test.LList a) | v == LNil} | VV == LNil}</span><span class='hs-conid'>LNil</span></a>
<span class=hs-linenum> 34: </span><span class='hs-definition'>lbind</span> <span class='hs-layout'>(</span><span class='hs-conid'>LCons</span> <span class='hs-varid'>x</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-varid'>f</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (Test.LList a) | v == f x}</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>`lappend`</span> <a class=annot href="#"><span class=annottext>{v : (Test.LList a) | v == lbind xs f}</span><span class='hs-varid'>lbind</span></a> <a class=annot href="#"><span class=annottext>{v : (Test.LList a) | v == xs}</span><span class='hs-varid'>xs</span></a> <a class=annot href="#"><span class=annottext>a -&gt; (Test.LList b)</span><span class='hs-varid'>f</span></a>
<span class=hs-linenum> 35: </span>
<span class=hs-linenum> 36: </span><span class='hs-comment'>-- Function. Map a function over a list.</span>
<span class=hs-linenum> 37: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>reflect</span> <span class='hs-varid'>lmap</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 38: </span><span class='hs-definition'>lmap</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>LList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>LList</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 39: </span><a class=annot href="#"><span class=annottext>forall a b .
x1:(a -&gt; b) -&gt; x3:(Test.LList a) -&gt; {VV : (Test.LList b) | VV == lmap x1 x3}</span><span class='hs-definition'>lmap</span></a> <a class=annot href="#"><span class=annottext>a -&gt; b</span><span class='hs-varid'>f</span></a> <span class='hs-conid'>LNil</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a . {v : (Test.LList a) | v == LNil} | VV == LNil}</span><span class='hs-conid'>LNil</span></a>
<span class=hs-linenum> 40: </span><span class='hs-definition'>lmap</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>LCons</span> <span class='hs-varid'>x</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      x1:a -&gt; x2:(Test.LList a) -&gt; {v : (Test.LList a) | LCons##lqdc##$select v == x2
                                                         &amp;&amp; LCons##lqdc##$select v == x1
                                                         &amp;&amp; v == LCons x1 x2} | VV == LCons}</span><span class='hs-conid'>LCons</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == f x}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>f</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : (Test.LList a) | v == lmap f xs}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>lmap</span> <a class=annot href="#"><span class=annottext>a -&gt; b</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{v : (Test.LList a) | v == xs}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 41: </span>
<span class=hs-linenum> 42: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>reflect</span> <span class='hs-varid'>lzip</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 43: </span><span class='hs-comment'>-- Function. Map a binary function over two lists (zipping).</span>
<span class=hs-linenum> 44: </span><span class='hs-definition'>lzip</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>LList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>LList</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>LList</span> <span class='hs-varid'>c</span>
<span class=hs-linenum> 45: </span><a class=annot href="#"><span class=annottext>forall a b c .
x1:(a -&gt; b -&gt; c) -&gt; x4:(Test.LList a) -&gt; x5:(Test.LList b) -&gt; {VV : (Test.LList c) | VV == lzip x1 x4 x5
                                                                                     &amp;&amp; VV == lbind x4 lam x##aaQA : a##xo . lbind x5 lam y##aaQB : b##xo . llist1 (x1 x##aaQA y##aaQB)}</span><span class='hs-definition'>lzip</span></a> <a class=annot href="#"><span class=annottext>a -&gt; b -&gt; c</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>(Test.LList a)</span><span class='hs-varid'>xs</span></a> <a class=annot href="#"><span class=annottext>(Test.LList a)</span><span class='hs-varid'>ys</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>lbind</span> <a class=annot href="#"><span class=annottext>{v : (Test.LList a) | v == xs}</span><span class='hs-varid'>xs</span></a> <a class=annot href="#"><span class=annottext>a -&gt; (Test.LList b)</span><span class='hs-layout'>(</span></a><span class='hs-keyglyph'>\</span><a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>lbind</span> <a class=annot href="#"><span class=annottext>{v : (Test.LList a) | v == ys}</span><span class='hs-varid'>ys</span></a> <a class=annot href="#"><span class=annottext>{VV : forall a .
      x1:a -&gt; {v : (Test.LList a) | v == llist1 x1
                                    &amp;&amp; v == LCons x1 LNil} | VV == llist1}</span><span class='hs-layout'>(</span></a><span class='hs-keyglyph'>\</span><a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>y</span></a> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>llist1</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == f x y}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>f</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == y}</span><span class='hs-varid'>y</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 46: </span>
<span class=hs-linenum> 47: </span><span class='hs-comment'>-- Function. Nondeterministically split a list into two sublists.</span>
<span class=hs-linenum> 48: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>reflect</span> <span class='hs-varid'>split</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 49: </span><span class='hs-definition'>split</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>LList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>LList</span> <span class='hs-layout'>(</span><span class='hs-conid'>LList</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>LList</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 50: </span><a class=annot href="#"><span class=annottext>forall a .
x1:(Test.LList a) -&gt; {VV : (Test.LList ((Test.LList a), (Test.LList a))) | VV == split x1}</span><span class='hs-definition'>split</span></a> <span class='hs-conid'>LNil</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      x1:a -&gt; {v : (Test.LList a) | v == llist1 x1
                                    &amp;&amp; v == LCons x1 LNil} | VV == llist1}</span><span class='hs-varid'>llist1</span></a> <a class=annot href="#"><span class=annottext>((Test.LList a), (Test.LList a))</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{VV : forall a . {v : (Test.LList a) | v == LNil} | VV == LNil}</span><span class='hs-conid'>LNil</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV : forall a . {v : (Test.LList a) | v == LNil} | VV == LNil}</span><span class='hs-conid'>LNil</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 51: </span><span class='hs-definition'>split</span> <span class='hs-layout'>(</span><span class='hs-conid'>LCons</span> <span class='hs-varid'>x</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 52: </span>  <a class=annot href="#"><span class=annottext>{v : (Test.LList ((Test.LList a), (Test.LList a))) | v == split xs}</span><span class='hs-varid'>split</span></a> <a class=annot href="#"><span class=annottext>{v : (Test.LList a) | v == xs}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum> 53: </span>    <span class='hs-varop'>`lbind`</span> <span class='hs-keyglyph'>\</span><span class='hs-layout'>(</span><span class='hs-varid'>ys</span><span class='hs-layout'>,</span> <span class='hs-varid'>zs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum> 54: </span>      <a class=annot href="#"><span class=annottext>(Test.LList ((Test.LList a), (Test.LList a)))</span><span class='hs-varid'>llist1</span></a> <a class=annot href="#"><span class=annottext>{v : ((Test.LList a), (Test.LList a)) | x_Tuple22 v == zs
                                        &amp;&amp; lqdc##$select v == zs
                                        &amp;&amp; snd v == zs}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : (Test.LList a) | LCons##lqdc##$select v == ys
                      &amp;&amp; LCons##lqdc##$select v == x
                      &amp;&amp; v == LCons x ys}</span><span class='hs-conid'>LCons</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v : (Test.LList a) | v == ys}</span><span class='hs-varid'>ys</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{v : (Test.LList a) | v == zs}</span><span class='hs-varid'>zs</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>`lappend`</span> <a class=annot href="#"><span class=annottext>(Test.LList ((Test.LList a), (Test.LList a)))</span><span class='hs-varid'>llist1</span></a> <a class=annot href="#"><span class=annottext>{v : ((Test.LList a), (Test.LList a)) | x_Tuple21 v == ys
                                        &amp;&amp; lqdc##$select v == ys
                                        &amp;&amp; fst v == ys}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : (Test.LList a) | v == ys}</span><span class='hs-varid'>ys</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{v : (Test.LList a) | LCons##lqdc##$select v == zs
                      &amp;&amp; LCons##lqdc##$select v == x
                      &amp;&amp; v == LCons x zs}</span><span class='hs-conid'>LCons</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v : (Test.LList a) | v == zs}</span><span class='hs-varid'>zs</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 55: </span>
<span class=hs-linenum> 56: </span><span class='hs-comment'>-- Function. Nondeterministically permute a list.</span>
<span class=hs-linenum> 57: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>reflect</span> <span class='hs-varid'>permute</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 58: </span><span class='hs-definition'>permute</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>LList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>LList</span> <span class='hs-layout'>(</span><span class='hs-conid'>LList</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 59: </span><a class=annot href="#"><span class=annottext>forall a .
x1:(Test.LList a) -&gt; {VV : (Test.LList (Test.LList a)) | VV == permute x1}</span><span class='hs-definition'>permute</span></a> <span class='hs-conid'>LNil</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (Test.LList a) | v == LNil}</span><span class='hs-varid'>llist1</span></a> <a class=annot href="#"><span class=annottext>{VV : forall a . {v : (Test.LList a) | v == LNil} | VV == LNil}</span><span class='hs-conid'>LNil</span></a>
<span class=hs-linenum> 60: </span><span class='hs-definition'>permute</span> <span class='hs-layout'>(</span><span class='hs-conid'>LCons</span> <span class='hs-varid'>x</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a .
x1:a -&gt; x2:(Test.LList a) -&gt; {VV : (Test.LList (Test.LList a)) | VV == permute_LCons x1 x2
                                                                 &amp;&amp; VV == lbind (split x2) (permute_LCons_f1 x1)}</span><span class='hs-varid'>permute_LCons</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v : (Test.LList a) | v == xs}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum> 61: </span>
<span class=hs-linenum> 62: </span><span class='hs-comment'>-- Function. The `LCons` case for `permute`.</span>
<span class=hs-linenum> 63: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>reflect</span> <span class='hs-varid'>permute_LCons</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 64: </span><span class='hs-definition'>permute_LCons</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>LList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>LList</span> <span class='hs-layout'>(</span><span class='hs-conid'>LList</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 65: </span><a class=annot href="#"><span class=annottext>forall a .
x1:a -&gt; x2:(Test.LList a) -&gt; {VV : (Test.LList (Test.LList a)) | VV == permute_LCons x1 x2
                                                                 &amp;&amp; VV == lbind (split x2) (permute_LCons_f1 x1)}</span><span class='hs-definition'>permute_LCons</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>(Test.LList a)</span><span class='hs-varid'>xs</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (Test.LList ((Test.LList a), (Test.LList a))) | v == split xs}</span><span class='hs-varid'>split</span></a> <a class=annot href="#"><span class=annottext>{v : (Test.LList a) | v == xs}</span><span class='hs-varid'>xs</span></a> <span class='hs-varop'>`lbind`</span> <a class=annot href="#"><span class=annottext>x1:((Test.LList a), (Test.LList a)) -&gt; {VV : (Test.LList (Test.LList a)) | VV == permute_LCons_f1 x x1
                                                                           &amp;&amp; VV == lzip (permute_LCons_f2 x) (permute (lqdc##$select x1)) (permute (lqdc##$select x1))}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>permute_LCons_f1</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 66: </span>
<span class=hs-linenum> 67: </span><span class='hs-comment'>-- Function. Auxilliary for `permute_LCons`.</span>
<span class=hs-linenum> 68: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>reflect</span> <span class='hs-varid'>permute_LCons_f1</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 69: </span><span class='hs-definition'>permute_LCons_f1</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>LList</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>LList</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>LList</span> <span class='hs-layout'>(</span><span class='hs-conid'>LList</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 70: </span><a class=annot href="#"><span class=annottext>forall a .
x1:a -&gt; x2:((Test.LList a), (Test.LList a)) -&gt; {VV : (Test.LList (Test.LList a)) | VV == permute_LCons_f1 x1 x2
                                                                                   &amp;&amp; VV == lzip (permute_LCons_f2 x1) (permute (lqdc##$select x2)) (permute (lqdc##$select x2))}</span><span class='hs-definition'>permute_LCons_f1</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <span class='hs-layout'>(</span><span class='hs-varid'>ys</span><span class='hs-layout'>,</span> <span class='hs-varid'>zs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b c .
      x1:(a -&gt; b -&gt; c) -&gt; x4:(Test.LList a) -&gt; x5:(Test.LList b) -&gt; {v : (Test.LList c) | v == lzip x1 x4 x5
                                                                                          &amp;&amp; v == lbind x4 lam x##aaQA : a##xo . lbind x5 lam y##aaQB : b##xo . llist1 (x1 x##aaQA y##aaQB)} | VV == lzip}</span><span class='hs-varid'>lzip</span></a> <a class=annot href="#"><span class=annottext>x1:(Test.LList a) -&gt; x2:(Test.LList a) -&gt; {v : (Test.LList a) | v == permute_LCons_f2 x x1 x2
                                                                &amp;&amp; v == lappend (lappend x1 (llist1 x)) x2}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>permute_LCons_f2</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{VV : (Test.LList (Test.LList a)) | VV == permute ys}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>permute</span> <a class=annot href="#"><span class=annottext>{v : (Test.LList a) | v == ys}</span><span class='hs-varid'>ys</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{VV : (Test.LList (Test.LList a)) | VV == permute zs}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>permute</span> <a class=annot href="#"><span class=annottext>{v : (Test.LList a) | v == zs}</span><span class='hs-varid'>zs</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 71: </span>
<span class=hs-linenum> 72: </span><span class='hs-comment'>-- Function. Auxilliary for `permute_LCons_f2`.</span>
<span class=hs-linenum> 73: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>reflect</span> <span class='hs-varid'>permute_LCons_f2</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 74: </span><span class='hs-definition'>permute_LCons_f2</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>LList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>LList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>LList</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 75: </span><a class=annot href="#"><span class=annottext>forall a .
x1:a -&gt; x2:(Test.LList a) -&gt; x3:(Test.LList a) -&gt; {VV : (Test.LList a) | VV == permute_LCons_f2 x1 x2 x3
                                                                         &amp;&amp; VV == lappend (lappend x2 (llist1 x1)) x3}</span><span class='hs-definition'>permute_LCons_f2</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>(Test.LList a)</span><span class='hs-varid'>ys'</span></a> <a class=annot href="#"><span class=annottext>(Test.LList a)</span><span class='hs-varid'>zs'</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (Test.LList a) | v == ys'}</span><span class='hs-varid'>ys'</span></a> <span class='hs-varop'>`lappend`</span> <a class=annot href="#"><span class=annottext>{v : (Test.LList a) | v == llist1 x
                      &amp;&amp; v == LCons x LNil}</span><span class='hs-varid'>llist1</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>`lappend`</span> <a class=annot href="#"><span class=annottext>{v : (Test.LList a) | v == zs'}</span><span class='hs-varid'>zs'</span></a>
<span class=hs-linenum> 76: </span>
<span class=hs-linenum> 77: </span><span class='hs-comment'>-- Example.</span>
<span class=hs-linenum> 78: </span><span class='hs-keyword'>{-@</span>
<span class=hs-linenum> 79: </span><span class='hs-definition'>permute_LCons_check</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>xs</span><span class='hs-conop'>:</span><span class='hs-conid'>LList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum> 80: </span>  <span class='hs-keyword'>{permute (LCons x xs) = lbind (split xs) (permute_LCons_f1 x)}</span>
<span class=hs-linenum> 81: </span><span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 82: </span><span class='hs-definition'>permute_LCons_check</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>LList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Proof</span>
<span class=hs-linenum> 83: </span><a class=annot href="#"><span class=annottext>forall a .
x1:a -&gt; x2:(Test.LList a) -&gt; {VV : () | permute (LCons x1 x2) == lbind (split x2) (permute_LCons_f1 x1)}</span><span class='hs-definition'>permute_LCons_check</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>(Test.LList a)</span><span class='hs-varid'>xs</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 84: </span>  <a class=annot href="#"><span class=annottext>(Test.LList (Test.LList a))</span><span class='hs-varid'>permute</span></a> <a class=annot href="#"><span class=annottext>{v : (Test.LList a) | LCons##lqdc##$select v == xs
                      &amp;&amp; LCons##lqdc##$select v == x
                      &amp;&amp; v == LCons x xs}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>LCons</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v : (Test.LList a) | v == xs}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 85: </span>    <span class='hs-varop'>==.</span> <a class=annot href="#"><span class=annottext>{v : (Test.LList (Test.LList a)) | v == permute_LCons x xs
                                   &amp;&amp; v == lbind (split xs) (permute_LCons_f1 x)}</span><span class='hs-varid'>permute_LCons</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v : (Test.LList a) | v == xs}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum> 86: </span>    <span class='hs-varop'>==.</span> <a class=annot href="#"><span class=annottext>{v : (Test.LList ((Test.LList a), (Test.LList a))) | v == split xs}</span><span class='hs-varid'>split</span></a> <a class=annot href="#"><span class=annottext>{v : (Test.LList a) | v == xs}</span><span class='hs-varid'>xs</span></a> <span class='hs-varop'>`lbind`</span> <a class=annot href="#"><span class=annottext>x1:((Test.LList a), (Test.LList a)) -&gt; {v : (Test.LList (Test.LList a)) | v == permute_LCons_f1 x x1
                                                                          &amp;&amp; v == lzip (permute_LCons_f2 x) (permute (lqdc##$select x1)) (permute (lqdc##$select x1))}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>permute_LCons_f1</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 87: </span>    <span class='hs-varop'>***</span> <a class=annot href="#"><span class=annottext>{v : Language.Haskell.Liquid.Equational.QED | v == QED}</span><span class='hs-conid'>QED</span></a>
<span class=hs-linenum> 88: </span>
<span class=hs-linenum> 89: </span><span class='hs-comment'>--</span>
<span class=hs-linenum> 90: </span><span class='hs-comment'>-- ! OLD 1</span>
<span class=hs-linenum> 91: </span><span class='hs-comment'>--</span>
<span class=hs-linenum> 92: </span>
<span class=hs-linenum> 93: </span><span class='hs-comment'>-- -- Function. Nondeterministically permute a list.</span>
<span class=hs-linenum> 94: </span><span class='hs-comment'>-- {-@ reflect permute @-}</span>
<span class=hs-linenum> 95: </span><span class='hs-comment'>-- permute :: LList a -&gt; LList (LList a)</span>
<span class=hs-linenum> 96: </span><span class='hs-comment'>-- permute LNil = llist1 LNil</span>
<span class=hs-linenum> 97: </span><span class='hs-comment'>-- permute (LCons x xs) =</span>
<span class=hs-linenum> 98: </span><span class='hs-comment'>--   split xs `lbind` \(ys, zs) -&gt;</span>
<span class=hs-linenum> 99: </span><span class='hs-comment'>--     lzip</span>
<span class=hs-linenum>100: </span><span class='hs-comment'>--       (\ys' zs' -&gt; ys' `lappend` llist1 x `lappend` zs')</span>
<span class=hs-linenum>101: </span><span class='hs-comment'>--       (permute ys)</span>
<span class=hs-linenum>102: </span><span class='hs-comment'>--       (permute zs)</span>
<span class=hs-linenum>103: </span>
<span class=hs-linenum>104: </span><span class='hs-comment'>-- -- Function. The expanded form of `permute` on an `LCons`.</span>
<span class=hs-linenum>105: </span><span class='hs-comment'>-- {-@ reflect permute_LCons_expansion @-}</span>
<span class=hs-linenum>106: </span><span class='hs-comment'>-- permute_LCons_expansion :: a -&gt; LList a -&gt; LList (LList a)</span>
<span class=hs-linenum>107: </span><span class='hs-comment'>-- permute_LCons_expansion x xs =</span>
<span class=hs-linenum>108: </span><span class='hs-comment'>--   split xs</span>
<span class=hs-linenum>109: </span><span class='hs-comment'>--     `lbind` ( \(ys, zs) -&gt;</span>
<span class=hs-linenum>110: </span><span class='hs-comment'>--                 lzip</span>
<span class=hs-linenum>111: </span><span class='hs-comment'>--                   (\ys' zs' -&gt; ys' `lappend` llist1 x `lappend` zs')</span>
<span class=hs-linenum>112: </span><span class='hs-comment'>--                   (permute ys)</span>
<span class=hs-linenum>113: </span><span class='hs-comment'>--                   (permute zs)</span>
<span class=hs-linenum>114: </span><span class='hs-comment'>--             )</span>
<span class=hs-linenum>115: </span>
<span class=hs-linenum>116: </span><span class='hs-comment'>-- -- -- Theorem. `permute_LCons_expansion` corresponds to `permute` on an `LCons`.</span>
<span class=hs-linenum>117: </span><span class='hs-comment'>-- -- {-@</span>
<span class=hs-linenum>118: </span><span class='hs-comment'>-- -- permute_LCons_expansion_correct :: x:a -&gt; xs:LList a -&gt;</span>
<span class=hs-linenum>119: </span><span class='hs-comment'>-- --   {permute (LCons x xs) = permute_LCons_expansion x xs}</span>
<span class=hs-linenum>120: </span><span class='hs-comment'>-- -- @-}</span>
<span class=hs-linenum>121: </span><span class='hs-comment'>-- permute_LCons_expansion_correct :: a -&gt; LList a -&gt; Proof</span>
<span class=hs-linenum>122: </span><span class='hs-comment'>-- permute_LCons_expansion_correct x xs =</span>
<span class=hs-linenum>123: </span><span class='hs-comment'>--   permute (LCons x xs)</span>
<span class=hs-linenum>124: </span><span class='hs-comment'>--     ==. ( split xs</span>
<span class=hs-linenum>125: </span><span class='hs-comment'>--             &gt;&gt;= ( \(ys, zs) -&gt;</span>
<span class=hs-linenum>126: </span><span class='hs-comment'>--                     lzip</span>
<span class=hs-linenum>127: </span><span class='hs-comment'>--                       (\ys' zs' -&gt; ys' `lappend` llist1 x `lappend` zs')</span>
<span class=hs-linenum>128: </span><span class='hs-comment'>--                       (permute ys)</span>
<span class=hs-linenum>129: </span><span class='hs-comment'>--                       (permute zs)</span>
<span class=hs-linenum>130: </span><span class='hs-comment'>--                 )</span>
<span class=hs-linenum>131: </span><span class='hs-comment'>--         )</span>
<span class=hs-linenum>132: </span><span class='hs-comment'>--     ==. permute_LCons_expansion x xs</span>
<span class=hs-linenum>133: </span><span class='hs-comment'>--     *** QED</span>
</pre>
</body>
</html>